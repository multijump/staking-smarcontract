"use strict";function ownKeys(n,e){var t,o=Object.keys(n);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(n),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),o.push.apply(o,t)),o}function _objectSpread(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,n,t,o,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(o,r)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(n,t){var o=s.apply(e,i);function r(e){asyncGeneratorStep(o,n,t,r,a,"next",e)}function a(e){asyncGeneratorStep(o,n,t,r,a,"throw",e)}r(void 0)})}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}var SIDE_NAMES={token0:"token0",token1:"token1"},TOKENS={token0:{},token1:{}},userInfo={lpBalance:0,isApproved:!1,pairAddress:null};function init(){return _init.apply(this,arguments)}function _init(){return(_init=_asyncToGenerator(regeneratorRuntime.mark(function e(){var n,t,o,r,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.variables,t=n.ZERO,o=n.TOKEN_LIST,r=n.NETWORK,a=o[r],i=getUrlParameter(SIDE_NAMES.token0)||t,s=getUrlParameter(SIDE_NAMES.token1)||t,TOKENS.token0=a.find(function(e){return e.address.toLowerCase()===i}),TOKENS.token1=a.find(function(e){return e.address.toLowerCase()===s}),$("#remove-form__from-token-img").attr("src",TOKENS.token0.logoURI),$("#remove-form__from-token-symbol").text(TOKENS.token0.symbol),$("#remove-form__to-token-img").attr("src",TOKENS.token1.logoURI),$("#remove-form__to-token-symbol").text(TOKENS.token1.symbol),e.next=12,updatePairInfo();case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function onConfirmRemove(){return _onConfirmRemove.apply(this,arguments)}function _onConfirmRemove(){return(_onConfirmRemove=_asyncToGenerator(regeneratorRuntime.mark(function e(){var n,t,o,r,a,i,s,c,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=TOKENS.token0,t=TOKENS.token1,$(".popup-overlay#confirm_remove").fadeOut(200),$(".popup-overlay#pending_transaction").fadeIn(200),$(".popup__pending-details-info").text("\n    Removing ".concat(n.withdrawAmount.dp(6,1).toString(10)," ").concat(n.symbol," and ").concat(t.withdrawAmount.dp(6,1).toString(10)," ").concat(t.symbol,"\n  ")),o=window.variables,r=o.ACCOUNT,a=o.ROUTER_CONTRACT,i=o.CONTRACT_ROUTER_ADDRESS,e.next=7,getBlockInfo();case 7:return s=e.sent,c=a.methods.removeLiquidity(n.address,t.address,"0x".concat(userInfo.withdrawLP.times(1e18).dp(0,0).toString(16)),0,0,r,s.timestamp+120).encodeABI(),e.t0=r,e.t1=i,e.t2=window.web3.utils,e.next=14,window.web3.eth.getGasPrice();case 14:e.t3=e.sent,e.t4=e.t2.toHex.call(e.t2,e.t3),e.t5=c,p={from:e.t0,to:e.t1,gasPrice:e.t4,data:e.t5,value:"0x0"},window.web3.eth.sendTransaction(p).on("transactionHash",function(e){handleTransactionSuccess(e),services.push({text:"Remove ".concat(n.withdrawAmount.dp(6,1).toString(10)," ").concat(n.symbol," and ").concat(t.withdrawAmount.dp(6,1).toString(10)," ").concat(t.symbol),hash:e})}).on("receipt",function(e){console.log("receipt :>> ",e),handlePercent(0),updatePairInfo(),services.update(e)}).on("error",function(e,n){console.log("err :>> ",e),handleTransactionError(),n&&services.update(n)});case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function handleTransactionSuccess(e){$(".popup-overlay#pending_transaction").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup__transaction-img").attr("src","images/swap/submit.svg"),$(".popup-overlay .popup__transaction-title").text("Transaction Submitted"),$(".popup-overlay .popup__transaction-title").after('\n    <a\n      target="_blank"\n      rel="noopener noreferrer"\n      href="'.concat(netLink(e),'"\n      class="popup__transaction-link">\n      View on ').concat(netScan(),"\n    </a>\n  ")),$(".popup-overlay .popup__transaction-btn").text("Close")}function handleTransactionError(){$(".popup-overlay#pending_transaction").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup__transaction-img").attr("src","images/swap/error.svg"),$(".popup-overlay .popup__transaction-title").text("Transaction Rejected."),$(".popup-overlay .popup__transaction-btn").text("Dismiss")}function getTokenSymbol(e){return e.address===window.variables.ZERO?BASE_SYMBOL:e.symbol}function getTokenLogoUrl(e){return e.address===window.variables.ZERO?BASE_LOGO:(null==e?void 0:e.logoURI)||"images/defaultAsset.svg"}function getUrlParameter(e){for(var n,t=window.location.search.substring(1).split("&"),o=0;o<t.length;o++)if((n=t[o].split("="))[0]===e)return void 0===_typeof(n[1])||decodeURIComponent(n[1]);return!1}function updatePairInfo(){return _updatePairInfo.apply(this,arguments)}function _updatePairInfo(){return(_updatePairInfo=_asyncToGenerator(regeneratorRuntime.mark(function e(){var n,t,o,r,a,i,s,c,p,u,m,d,l,v,_,f,b,w,y,S,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.variables.FACTORY_CONTRACT=new web3.eth.Contract(window.variables.CONTRACT_FACTORY_ABI,window.variables.CONTRACT_FACTORY_ADDRESS),n=window.variables,t=n.CONTRACT_FACTORY_ABI,o=n.CONTRACT_FACTORY_ADDRESS,r=n.CONTRACT_ROUTER_ADDRESS,a=n.ACCOUNT,i=new web3.eth.Contract(t,o),e.next=5,i.methods.getPair(TOKENS.token0.address,TOKENS.token1.address).call();case 5:return s=e.sent,userInfo.pairAddress=s,c=getPairTokenContract(s),e.next=10,c.methods.token0().call();case 10:return p=e.sent,e.next=13,c.methods.balanceOf(a).call();case 13:return u=e.sent,e.next=16,c.methods.totalSupply().call();case 16:return m=e.sent,e.next=19,c.methods.allowance(a,r).call();case 19:return d=e.sent,l=p===TOKENS.token0.address?TOKENS.token0.decimals:TOKENS.token1.decimals,v=p===TOKENS.token0.address?TOKENS.token1.decimals:TOKENS.token0.decimals,e.next=24,c.methods.getReserves().call();case 24:_=e.sent,f=_._reserve0,b=_._reserve1,w=new BigNumber(f).times(new BigNumber(u).div(new BigNumber(m))).div(new BigNumber(10).pow(l)),y=new BigNumber(b).times(new BigNumber(u).div(new BigNumber(m))).div(new BigNumber(10).pow(v)),p===TOKENS.token0.address?(TOKENS.token0=_objectSpread(_objectSpread({},TOKENS.token0),{},{amount:w}),TOKENS.token1=_objectSpread(_objectSpread({},TOKENS.token1),{},{amount:y})):(TOKENS.token0=_objectSpread(_objectSpread({},TOKENS.token0),{},{amount:y}),TOKENS.token1=_objectSpread(_objectSpread({},TOKENS.token1),{},{amount:w})),S=TOKENS.token0,g=TOKENS.token1,$(".remove-form__price").html('\n    <div class="remove-form__price-title">Price:</div>\n    <div class="remove-form__price-values">\n      <div class="remove-form__price-values-item">1 '.concat(S.symbol," = ").concat(g.amount.div(S.amount).dp(6,1).toString(10)," ").concat(g.symbol,'</div>\n      <div class="remove-form__price-values-item">1 ').concat(g.symbol," = ").concat(S.amount.div(g.amount).dp(6,1).toString(10)," ").concat(S.symbol,"</div>\n    </div>\n  ")),userInfo.lpBalance=new BigNumber(u).div(1e18),userInfo.isApproved=!new BigNumber(d).isZero();case 34:case"end":return e.stop()}},e)}))).apply(this,arguments)}function onPercentChange(e,n){handlePercent(n||e.target.value)}function onApprove(){var e=window.variables,n=e.CONTRACT_ROUTER_ADDRESS,t=e.ACCOUNT,o=getPairTokenContract(userInfo.pairAddress);$(".remove-form__action-btn").addClass("btn-disabled"),$(".remove-form__action-btn").text("Approving..."),send(o.methods.approve)(n,new BigNumber(2).pow(256).minus(1).toString(10),{from:t}).send().on("transactionHash",function(e){services.push({text:"Approve ".concat(TOKENS.token0.symbol,"/").concat(TOKENS.token1.symbol," LP"),hash:e})}).on("receipt",function(e){userInfo.isApproved=!0,handlePercent(0),services.update(e)}).on("error",function(e,n){console.log("error :>> ",e),$(".remove-form__action-btn").removeClass("btn-disabled"),$(".remove-form__action-btn").text("Approve"),n&&services.update(n)})}function handlePercent(e){TOKENS.token0=_objectSpread(_objectSpread({},TOKENS.token0),{},{withdrawAmount:TOKENS.token0.amount.times(Number(e)).div(100)}),TOKENS.token1=_objectSpread(_objectSpread({},TOKENS.token1),{},{withdrawAmount:TOKENS.token1.amount.times(Number(e)).div(100)}),userInfo.withdrawLP=userInfo.lpBalance.times(Number(e)).div(100),$(".remove-form__amount-percent").text("".concat(e," %")),$(".remove-form__amount-range").val(e),0===Number(e)?($(".remove-token0-amount").text("-"),$(".remove-token1-amount").text("-"),$(".remove-form__action").html('\n      <div class="remove-form__action-btn btn btn-big btn-disabled">\n        Enter Amount\n      </div>\n    ')):($(".remove-token0-amount").text(TOKENS.token0.withdrawAmount.dp(8,1).toString(10)),$(".remove-token1-amount").text(TOKENS.token1.withdrawAmount.dp(8,1).toString(10)),userInfo.isApproved?$(".remove-form__action").html('\n        <div\n          class="remove-form__action-btn btn btn-big js-popup-open"\n          href="#confirm_remove"\n        >\n          Remove\n        </div>\n      '):$(".remove-form__action").html('\n        <div\n          class="remove-form__action-btn btn btn-big"\n          data-event-click="onApprove"\n        >\n          Approve\n        </div>\n      '))}function initRemoveModal(){var e=TOKENS.token0,n=TOKENS.token1;$(".popup__remove-token0").html('\n    <div class="popup__remove-token-value">'.concat(e.withdrawAmount.dp(8,1).toString(10),'</div>\n    <div class="popup__remove-token-label">\n      <img src="').concat(e.logoURI,'" width="24px" height="24px">\n      <span>').concat(e.symbol,"</span>\n    </div>\n  ")),$(".popup__remove-token1").html('\n    <div class="popup__remove-token-value">'.concat(n.withdrawAmount.dp(8,1).toString(10),'</div>\n    <div class="popup__remove-token-label">\n      <img src="').concat(n.logoURI,'" width="24px" height="24px">\n      <span>').concat(n.symbol,"</span>\n    </div>\n  ")),$(".popup__remove-burn").html('\n    <div class="popup__remove-burn-label">LP '.concat(e.symbol,"/").concat(n.symbol,' Burned</div>\n    <div class="popup__remove-burn-value">\n      <img src="').concat(e.logoURI,'" width="24px" height="24px">\n      <img src="').concat(n.logoURI,'" width="24px" height="24px">\n      <span>').concat(userInfo.withdrawLP.dp(6,1).toString(10),"</span>\n    </div>\n  ")),$(".popup__remove-price").html('\n    <div class="popup__remove-price-title">Price:</div>\n    <div class="popup__remove-price-values">\n      <div class="popup__remove-price-values-item">1 '.concat(e.symbol," = ").concat(n.amount.div(e.amount).dp(6,1).toString(10)," ").concat(n.symbol,'</div>\n      <div class="popup__remove-price-values-item">1 ').concat(n.symbol," = ").concat(e.amount.div(n.amount).dp(6,1).toString(10)," ").concat(e.symbol,"</div>\n    </div>\n  "))}function onModalClose(){$(".popup-overlay").fadeOut(200)}window.onload=function(){window.triggers.selectAccount=[].concat(_toConsumableArray(window.triggers.selectAccount||[]),["init"]),window.events.init=init,window.events.onConfirmRemove=onConfirmRemove,window.events.onPercentChange=onPercentChange,window.events.onApprove=onApprove,window.events.initRemoveModal=initRemoveModal,window.events.onModalClose=onModalClose};