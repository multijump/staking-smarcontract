"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,a=!1,o=void 0;try{for(var s,i=t[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ownKeys(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var defaults={transactions:[]},networkLabels={1:"ETH Mainnet",3:"ETH Ropsten",4:"ETH Rinkeby",56:"BSC Mainnet",97:"BSC Testnet"},networkSuffix={3:" Network",4:" Network"},netURLs={1:"https://etherscan.io",3:"https://ropsten.etherscan.io",4:"https://rinkeby.etherscan.io",56:"https://bscscan.com"},scanApiURLs={1:"https://api.etherscan.io",3:"https://api-ropsten.etherscan.io",4:"https://api-rinkeby.etherscan.io",56:"https://api.bscscan.com"};function netLink(t,e){var n=window.variables.NETWORK;return"".concat(netURLs[e||n],"/tx/").concat(t)}var netScans={1:"Etherscan",3:"Etherscan(ropsten)",4:"Etherscan(rinkeby)",56:"Bscscan"};function netScan(t){var e=window.variables.NETWORK;return netScans[t||e]}window.services={key:"swipe-swap",mounter:".js-popup-open[href='#connect_wallet']",mounted:!1,watch:null,tick:5e3,expire:6e5,toastExpire:10,themes:["light-mode","dark-mode"],storage:defaults,importSuggest:{},load:function(){var t=this;localStorage.getItem(this.key)&&(this.storage=JSON.parse(localStorage.getItem(this.key))),this.loadTheme(),this.watch=setInterval(function(){t.checkTransactions()},this.tick),this.updateToasts(),this.loadImports(),$(document).on("click","#toasts .btn",function(){var t=$(this).data("href");t&&window.open(t),$(this).remove()})},save:function(){localStorage.setItem(this.key,JSON.stringify(this.storage)),this.updateToasts()},get transactions(){var n=window.variables.NETWORK;return n?this.storage.transactions.filter(function(t){var e=t.network;return(void 0===e?3:e)===n}):[]},set transactions(n){var r=this,a=n.map(function(t){return t.transactionHash});this.storage.transactions=this.transactions.map(function(e){if(a.includes(e.hash)){var t=n.find(function(t){return t.transactionHash===e.hash});return r.toast({id:e.id,text:e.text,link:netLink(e.hash),status:t.status}),_objectSpread(_objectSpread({},e),{},{receipt:t})}return e}),this.save(),this.checkPending()},get pendingTransaction(){var r=Date.now();return this.transactions.filter(function(t){var e=t.receipt,n=t.expireAt;return!e&&n&&r<n})},updateToasts:function(){!this.pendingTransaction.length&&this.transactions.length?($("#toasts .count .value").html(this.transactions.length),$("#toasts .count").show()):$("#toasts .count").hide();var s,t=$(".transactions");this.transactions.length?(t.find(".transactions__description").hide(),t.find("#clear-all").show(),s=t.find(".transactions__items"),t.find(".transactions__items").show(),s.html(""),this.transactions.forEach(function(t){var e=t.text,n=t.hash,r=t.receipt,a=t.network,o=void 0===a?3:a;return s.append('\n        <a href="'.concat(netLink(n,o),'" target="_blank">\n          ').concat(e,' <img src="/images/icons/').concat(r?r.status?"completed":"failed":"loading",'.svg" />\n        </a>\n      '))})):(t.find(".transactions__description").show(),t.find("#clear-all").hide(),t.find(".transactions__items").hide())},checkTransactions:function(){var e=this;web3&&this.pendingTransaction.length&&Promise.all(this.pendingTransaction.map(function(t){var e=t.hash;return web3.eth.getTransactionReceipt(e)})).then(function(t){e.transactions=t.filter(function(t){return!!t})}).catch(console.log)},checkSupported:function(){var t=window.variables.NETWORK;if(t){if(void 0===window.isETH)return;$(".swap-toggle__btn:nth-child(".concat(isETH?2:1,") input")).removeAttr("checked"),$(".swap-toggle__btn:nth-child(".concat(isETH?1:2,") input")).attr("checked","checked");var e=$(".base-token");e.find(".ticker").text(BASE_SYMBOL),e.find(".descr").text(BASE_ASSET),e.find("img").attr("src",BASE_LOGO),SUPPORTED_NETWORKS.includes(t)?($("#toasts .btn").remove(),0<this.pendingTransaction.length&&$("#toasts .count").show(),this.checkPending()):($("#toasts .count").hide(),$("#toasts .btn").remove(),$("#toasts").append('\n        <button class="btn btn-gray ease-in">\n          You are connected to '.concat(networkLabels[t]+(networkSuffix[t]||""),"<br>\n          <span>Our supported networks are ").concat(SUPPORTED_NETWORKS.map(function(t,e){var n="<b>".concat(networkLabels[t],"</b>");return e===SUPPORTED_NETWORKS.length-1?"and ".concat(n):n}).join(", "),"</span>\n        </button>\n      ")))}},checkPending:function(){var t;window.variables.NETWORK&&((t=this.pendingTransaction.length)?this.mount(t):(this.unMount(),this.updateToasts()))},mount:function(t){var e;this.mounted?$(".connect-btn a[href='#transactions']").text("".concat(t," pending")):(e=$(this.mounter),e.css("position","relative"),e.append('\n        <a href="#transactions" class="services-mounted js-popup-open">'.concat(t," pending</a>\n      ")),this.mounted=!0)},unMount:function(){$(this.mounter).find("[href='#transactions']").remove(),this.mounted=!1},clear:function(){this.storage.transactions=[],this.save()},push:function(t){var e=window.variables.NETWORK,n=Date.now();this.storage.transactions.unshift(_objectSpread(_objectSpread({},t),{},{id:n.toString(),expireAt:Date.now()+this.expire,network:e})),this.save(),this.checkPending()},update:function(t){this.transactions=[t]},toast:function(t){var e=t.id,n=t.text,r=t.link,a=t.status;$("#toasts").append('\n      <button class="btn btn-'.concat(a?"lbiege":"gray",'" data-href="').concat(r,'" id="tx-').concat(e,'">\n        ').concat(n," (<span>").concat(a?"Completed":"Failed","</span>)\n      </button>\n    ")),setTimeout(function(){return $("#tx-".concat(e)).addClass("ease-in")},500),setTimeout(function(){return $("#tx-".concat(e)).removeClass("ease-in").addClass("ease-out")},1e3*this.toastExpire),setTimeout(function(){return $("#tx-".concat(e)).remove()},1e3*(this.toastExpire+.5))},toggleTheme:function(){var t=this.storage.theme,e=void 0===t?0:t;$(document.body).removeClass(this.themes[e]),this.storage.theme=(e+1)%this.themes.length,this.loadTheme(),this.save()},loadTheme:function(){var t=this.storage.theme,e=void 0===t?0:t;$(".dark-mode-toggle input").attr("checked",1===e),$(document.body).addClass(this.themes[e])},tokenSuggest:function(t){var e="suggest-import-".concat(t.address);this.importSuggest[e]||(this.importSuggest[e]=t,$(".token-list").append('\n      <a class="token-list__item js-select-token" href="#" data-key="'.concat(t.address,'"><img src="').concat(t.logoURI,'" alt="').concat(t.name,'">\n        <div class="token-list__item-name">\n          <div class="ticker">').concat(t.symbol,'</div>\n          <div class="descr">').concat(t.name,'</div>\n          <div class="hidden">').concat(t.address,'</div>\n          <button class="btn btn-lbiege" id=').concat(e,">Import</button>\n        </div>\n      </a>\n    ")),"images/swap/error.svg"===t.logoURI?($(".swap-form-import__notice").show(),$(".swap-form-import__notice").html('\n        <img src="images/swap/error.svg" alt="'.concat(t.name,'" />\n        <h6>Trade at your own risk!</h6>\n        <p>Anyone can create a token, including creating fake versions of existing tokens that claim to represent projects.</p>\n        <p>If you purchase this token, you may not be able to sell it back.</p>\n      '))):$(".swap-form-import__notice").hide(),$("#".concat(e)).on("click",function(t){t.stopPropagation(),services.importToken(this)}),registerToken(t))},importToken:function(t){var e=this.importSuggest[t.id],n=window.variables.NETWORK,r=this.storage.imports,a=void 0===r?{}:r;a[n]?a[n].push(e):a[n]=[e],this.storage.imports=a,this.save(),$(t).remove()},loadImports:function(){var n=window.variables.TOKEN_LIST;delete this.storage.imports,this.save();var t=this.storage.imports,r=void 0===t?{}:t;Object.keys(r).forEach(function(t){var e;(e=n[t]).push.apply(e,_toConsumableArray(r[t]))}),$(".swap-form-import__notice").hide()}},window.events.load=function(){services.load(),$(document).on("click","[data-service-click]",function(t){var e,n=_slicedToArray(getTargetEvent(t,"data-service-click"),2),r=n[0],a=n[1],o=void 0===a?"":a;services[r]&&(e=services)[r].apply(e,[t].concat(_toConsumableArray(o.split(","))))}),$(document).on("click",".swap-toggle__btn",function(t){t.preventDefault();var e=window.variables.NETWORK,n=1;switch($(this).find("span").text()){case"Binance":n=56}e!==n&&changeNetworkRequest(n)})},window.events.checkSupported=function(){services.checkSupported()},window.triggers.onLoad=[].concat(_toConsumableArray(window.triggers.onLoad||[]),["load"]),window.triggers.networkChanged=[].concat(_toConsumableArray(window.triggers.networkChanged||[]),["checkSupported"]);