"use strict";function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(t,n){var r=s.apply(e,i);function o(e){asyncGeneratorStep(r,t,n,o,a,"next",e)}function a(e){asyncGeneratorStep(r,t,n,o,a,"throw",e)}o(void 0)})}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var SIDES={from:"to",to:"from"},pairList=[],pairMap={},midToken=null,SETTINGS={slippage:.5,deadline:20};function validAddr(e){var t=window.variables,n=t.ZERO,r=t.WETH;return e===n?r:e}function joinAddr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(validAddr).map(function(e){return e.toLowerCase()}).join("-")}function uniquePair(e,t){var n=[validAddr(e).toLowerCase(),validAddr(t).toLowerCase()],r=n[0]<n[1];return r||n.reverse(),[n.join("-"),r]}function sellPrice(e,t){var n=_slicedToArray(t,2),r=n[0],o=n[1],a=new BigNumber(e).times(new BigNumber(o)).times(997),i=new BigNumber(r).times(1e3).plus(e.times(997));return a.div(i)}function buyPrice(e,t){var n=_slicedToArray(t,2),r=n[0],o=n[1],a=new BigNumber(e).times(new BigNumber(o)).times(1e3),i=new BigNumber(r).minus(new BigNumber(e)).times(997);return a.div(i)}function getOrderPrice(e,t,n,r){if(0===n.length)return[new BigNumber(e),0,[]];var l=r?buyPrice:sellPrice;return(r?_toConsumableArray(n).reverse():n).reduce(function(e,t){var n=_slicedToArray(e,2),r=_slicedToArray(n[0],3),o=r[0],a=r[1],i=r[2],s=n[1]===t.token1.id,c=new BigNumber(s?t.token0Price:t.token1Price),u=s?[t.reserve1,t.reserve0]:[t.reserve0,t.reserve1],p=l(o,u),d=c.minus(p.div(o)).div(c).times(100).toNumber();return[[p,Math.abs((0<a?a:1)*d),[].concat(_toConsumableArray(i),[uniquePair(t.token0.id,t.token1.id)[0]])],s?t.token0.id:t.token1.id]},[[new BigNumber(e),0,[]],t])[0]}function checkValid(){var e,t,n,r,o,a,i,s,c=$(".swap-btn"),u=window.variables,p=u.ACCOUNT,d=u.ZERO,l=u.WETH;p?(e=$(".swap-form__input-row[data-input='from']"),t=$(".swap-form__input-row[data-input='to']"),n=getData(e.find("a.selected")),r=getData(t.find("a.selected")),n&&r?(o=TOKENS.from,a=TOKENS.to,o.isApproved?(i=e.find("input").val(),s=t.find("input").val(),i&&s?new BigNumber(i).gt(o.balance)?$(c).html('<button class="btn btn-big btn-disabled">Insufficient balance</button>'):o.token.address!==d||a.token.address!==l?o.token.address!==l||a.token.address!==d?$(c).html('\n    <button\n      class="btn btn-big js-popup-open"\n      href="#confirm_swap"\n      data-from-symbol="'.concat(getTokenSymbol(TOKENS.from.token),'"\n      data-from-amount="').concat(TOKENS.from.amount.dp(6,1).toString(10),'"\n      data-to-symbol="').concat(getTokenSymbol(TOKENS.to.token),'"\n      data-to-amount="').concat(TOKENS.to.amount.dp(6,1).toString(10),'"\n    >\n      Swap\n    </button>\n  ')):$(c).html('<button class="btn btn-big btn-swap-unwrap" data-event-click="onUnwrap">Unwrap</button>'):$(c).html('<button class="btn btn-big btn-swap-wrap" data-event-click="onWrap">Wrap</button>'):$(c).html('<button class="btn btn-big btn-disabled">Enter an amount</button>')):$(c).html('<button class="btn btn-big swap-approve-btn">Approve '.concat(o.token.symbol,"</button>"))):$(c).html('<button class="btn btn-big btn-disabled">Select a token</button>')):$(c).html('<button class="btn btn-big js-popup-open" href="#connect_wallet">Connect Wallet</button>')}function updateToken(e){var t=TOKENS[e].balance;$("#balance-".concat(e," span")).text(t.dp(2,1).toNumber())}window.onload=function(){window.triggers.selectAccount=[].concat(_toConsumableArray(window.triggers.selectAccount||[]),["init"]),window.events.init=init,window.events.onSelectToken=onSelectToken,window.events.onInputAmount=onInputAmount,window.events.onConfirmSwap=onConfirmSwap,window.events.onModalClose=onModalClose,window.events.onWrap=onWrap,window.events.onUnwrap=onUnwrap,window.events.onBalance=onBalance,window.events.onInputDeadline=onInputDeadline,$(document).on("click",".swap-approve-btn",function(e){e.preventDefault(),handleApprove()}),$(document).on("click",".swap-form__settings-slippage-values-item",function(e){e.preventDefault(),$(".swap-form__settings-slippage-values-item").removeClass("active"),$(this).addClass("active"),SETTINGS.slippage=parseFloat($(this).text().slice(0,-1)),TOKENS.to&&TOKENS.to.amount&&$(".swap-footer").find("#swap-min-received").html("\n          ".concat(TOKENS.to.amount.times(100-SETTINGS.slippage).div(100).dp(4,1).toString(10)," ").concat(getTokenSymbol(TOKENS.to.token),"\n        "))})};var refreshTimer=null;function init(){return _init.apply(this,arguments)}function _init(){return(_init=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.variables.ACCOUNT)return e.next=4,getTokenInfo();e.next=11;break;case 4:t=e.sent,n=_slicedToArray(t,3),r=n[0],o=n[1],a=n[2],TOKENS.from={balance:r,isApproved:o,token:a,amount:new BigNumber(0)},updateToken("from");case 11:refreshTimer&&clearInterval(refreshTimer),refreshPairs(!0),setInterval(function(){return refreshPairs()},6e4);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function refreshPairs(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];getFullPairs().then(function(e){pairMap=(pairList=e).reduce(function(e,t){var n=_slicedToArray(uniquePair(t.token0.id,t.token1.id),1)[0],r=n.split("-");return e[n]=t,e.pairs[r[0]]=[].concat(_toConsumableArray(e.pairs[r[0]]||[]),[r[1]]),e.pairs[r[1]]=[].concat(_toConsumableArray(e.pairs[r[1]]||[]),[t.token0.id]),e},{pairs:{},routes:{},getRoute:function(e,i,t){var s=this,c=2<arguments.length&&void 0!==t&&t,n=_slicedToArray(joinAddr.apply(void 0,_toConsumableArray(e)).split("-"),2),u=n[0],p=n[1];if(u===p)return[[u,getOrderPrice(i,u,[])]];var d=[],r=_slicedToArray(uniquePair(u,p),1)[0];return this[r]&&d.push([r,getOrderPrice(i,c?p:u,[this[r]],c)]),this.pairs[u]&&(this.pairs[u].filter(function(e){return s.pairs[e].includes(p)}).forEach(function(e){var t,n=_slicedToArray(uniquePair(u,e),1)[0],r=_slicedToArray(uniquePair(e,p),1)[0];s[n]&&s[r]&&(t=joinAddr(u,e,p),d.push([t,getOrderPrice(i,c?p:u,[s[n],s[r]],c)]))}),this.pairs[u].filter(function(e){return!s.pairs[e].includes(p)}).forEach(function(a){s.pairs[a].filter(function(e){return s.pairs[e].includes(p)}).forEach(function(e){var t,n=_slicedToArray(uniquePair(u,a),1)[0],r=_slicedToArray(uniquePair(a,e),1)[0],o=_slicedToArray(uniquePair(e,p),1)[0];s[r]&&s[o]&&(t=joinAddr(u,a,e,p),d.push([t,getOrderPrice(i,c?p:u,[s[n],s[r],s[o]],c)]))})})),d=d.filter(function(e){return 0<e[1][0].toNumber()}).sort(function(e,t){return(t[1][0].toNumber()-e[1][0].toNumber())*(c?-1:1)})}}),t&&checkValid()})}function onSelectToken(e,t){return _onSelectToken.apply(this,arguments)}function _onSelectToken(){return(_onSelectToken=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){var r,o,a,i,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=window.variables.ACCOUNT,!t){e.next=14;break}if(r)return e.next=5,getTokenInfo(n);e.next=14;break;case 5:return o=e.sent,a=_slicedToArray(o,3),i=a[0],s=a[1],c=a[2],TOKENS[t]={amount:TOKENS[t].amount,balance:i,isApproved:s,token:c},$("#balance-".concat(t," span")).text(i.dp(2,1).toNumber()),onInputAmount(null,t),e.abrupt("return");case 14:$("#balance-to span").text(TOKENS.from.balance?TOKENS.from.balance.dp(2,1).toNumber():"-"),$("#balance-from span").text(TOKENS.to.balance?TOKENS.to.balance.dp(2,1).toNumber():"-"),clear(),checkValid();case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function onInputAmount(e,t){return _onInputAmount.apply(this,arguments)}function _onInputAmount(){return(_onInputAmount=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){var r,o,a,i,s,c,u,p,d,l,m,f,b,w,T,v,S,h,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=TOKENS[n].amount,t&&(r=new BigNumber(t.target.value||"0"),TOKENS[n]=_objectSpread(_objectSpread({},TOKENS[n]),{},{amount:r})),o=$(".swap-form"),!r||r.isZero()||!TOKENS.to.token||!TOKENS.from.token){e.next=29;break}if(a=pairMap.getRoute([TOKENS.from.token.address,TOKENS.to.token.address],r,"to"===n),i=_slicedToArray(a,1),s=i[0]){e.next=8;break}return $(".swap-btn").html('<button class="btn btn-big btn-disabled">Insufficient liquidity for this trade</button>'),e.abrupt("return");case 8:if(c=_slicedToArray(s,2),u=c[0],p=_slicedToArray(c[1],3),d=p[0],l=p[1],m=p[2],(f=$(".swap-footer").find("#swap-price-impact")).removeClass("green").removeClass("red").addClass(10<l?"red":l<2.5?"green":"normal"),f.html("".concat(new BigNumber(l).dp(2,1).toString(10)," %")),b=window.variables,w=b.TOKEN_LIST,T=b.NETWORK,v=w[T],$("#swap-best-route").html(u.split("-").map(function(t){return v.find(function(e){return e.address.toLowerCase()===t})}).map(function(e){return'<img src="'.concat(e.logoURI,'"/>')+e.symbol}).join(" > ")),midToken=1<m.length?toChecksumAddress(u.split("-")[1]):null,TOKENS[SIDES[n]]=_objectSpread(_objectSpread({},TOKENS[SIDES[n]]),{},{amount:d}),o.find('[data-input="'.concat(SIDES[n],'"]')).find("input").val(d.dp(TOKENS[SIDES[n]].token.decimals||18,1).toString()),S=window.variables,h=S.ZERO,g=S.WETH,TOKENS.from.token.address===h&&TOKENS.to.token.address===g||TOKENS.from.token.address===g&&TOKENS.to.token.address===h)return checkValid(),$(".swap-footer").hide(),e.abrupt("return");e.next=23;break;case 23:$(".swap-form__price").html('\n      <div class="swap-form__price-content">\n        <div class="swap-form__price-content-label">Price</div>\n        <div class="swap-form__price-content-value">\n          '.concat(("to"===n?r:d).div("to"===n?d:r).dp(4,1).toString(10)," ").concat(getTokenSymbol(TOKENS.to.token)," per ").concat(getTokenSymbol(TOKENS.from.token),"\n        </div>\n      </div>\n    ")),$(".swap-footer").show(),$(".swap-footer").find("#swap-min-received").html("\n        ".concat(TOKENS.to.amount.times(100-SETTINGS.slippage).div(100).dp(4,1).toString(10)," ").concat(getTokenSymbol(TOKENS.to.token),"\n      ")),$(".swap-footer").find("#swap-lp-fee").html("".concat(TOKENS.from.amount.times(.003).dp((TOKENS.from.token.decimals||18)-2,1).toString(10)," ").concat(getTokenSymbol(TOKENS.from.token))),e.next=29;break;case 29:checkValid();case 30:case"end":return e.stop()}},e)}))).apply(this,arguments)}function clear(){$("#swap-from-token").val(""),$("#swap-to-token").val(""),$(".swap-form__price").empty(),$(".swap-footer").hide(),checkValid()}function handleApprove(){$(".swap-approve-btn").addClass("btn-disabled"),$(".swap-approve-btn").text("Approving...");var e=window.variables,t=e.ACCOUNT,n=e.CONTRACT_ERC20_ABI,r=new web3.eth.Contract(n,TOKENS.from.token.address);send(r.methods.approve)(window.variables.CONTRACT_ROUTER_ADDRESS,new BigNumber(2).pow(256).minus(1).toString(10),{from:t}).send().on("transactionHash",function(e){services.push({text:"Approve ".concat(TOKENS.from.token.symbol),hash:e})}).on("receipt",function(e){TOKENS.from=_objectSpread(_objectSpread({},TOKENS.from),{},{isApproved:!0}),checkValid(),services.update(e)}).on("error",function(e,t){console.log("error :>> ",e),$(".swap-approve-btn").removeClass("btn-disabled"),$(".swap-approve-btn").text("Approve ".concat(TOKENS.from.token.symbol)),t&&services.update(t)})}function onWrap(){return _onWrap.apply(this,arguments)}function _onWrap(){return(_onWrap=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $(".btn-swap-wrap").addClass("btn-disabled"),$(".btn-swap-wrap").text("Wrapping..."),t=window.variables,n=t.ACCOUNT,r=t.CONTRACT_WETH_ABI,o=t.WETH,a=new web3.eth.Contract(r,o),i=a.methods.deposit().encodeABI(),e.t0=n,e.t1=o,e.t2=window.web3.utils,e.next=10,window.web3.eth.getGasPrice();case 10:e.t3=e.sent,e.t4=e.t2.toHex.call(e.t2,e.t3),e.t5=i,e.t6="0x".concat(toWei(TOKENS.from.amount).toString(16)),s={from:e.t0,to:e.t1,gasPrice:e.t4,data:e.t5,value:e.t6},window.web3.eth.sendTransaction(s).on("transactionHash",function(e){console.log("hash :>> ",e),$(".btn-swap-wrap").removeClass("btn-disabled"),$(".btn-swap-wrap").text("Wrap"),handleTransactionSuccess(e),services.push({text:"Wrap ".concat(BASE_SYMBOL," for ").concat(TOKENS.from.amount.toFixed(4)," W").concat(BASE_SYMBOL),hash:e})}).on("receipt",function(e){services.update(e)}).on("error",function(e,t){console.log("err :>> ",e),$(".btn-swap-wrap").removeClass("btn-disabled"),$(".btn-swap-wrap").text("Wrap"),handleTransactionError(),t&&services.update(t)});case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function onUnwrap(){return _onUnwrap.apply(this,arguments)}function _onUnwrap(){return(_onUnwrap=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,o,a,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $(".btn-swap-unwrap").addClass("btn-disabled"),$(".btn-swap-unwrap").text("Unwrapping..."),t=window.variables,n=t.ACCOUNT,r=t.CONTRACT_WETH_ABI,o=t.WETH,a=new web3.eth.Contract(r,o),i=a.methods.withdraw("0x".concat(toWei(TOKENS.from.amount).toString(16))).encodeABI(),e.t0=n,e.t1=o,e.t2=window.web3.utils,e.next=10,window.web3.eth.getGasPrice();case 10:e.t3=e.sent,e.t4=e.t2.toHex.call(e.t2,e.t3),e.t5=i,s={from:e.t0,to:e.t1,gasPrice:e.t4,data:e.t5,value:"0x0"},window.web3.eth.sendTransaction(s).on("transactionHash",function(e){console.log("hash :>> ",e),$(".btn-swap-unwrap").removeClass("btn-disabled"),$(".btn-swap-unwrap").text("Unwrap"),handleTransactionSuccess(e),services.push({text:"Unwrap W".concat(BASE_SYMBOL," for ").concat(TOKENS.from.amount.toFixed(4)," ").concat(BASE_SYMBOL),hash:e})}).on("receipt",function(e){console.log("receipt :>> ",e),services.update(e)}).on("error",function(e,t){console.log("err :>> ",e),$(".btn-swap-unwrap").removeClass("btn-disabled"),$(".btn-swap-unwrap").text("Unwrap"),handleTransactionError(),t&&services.update(t)});case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function getTokenSymbol(e){return e.address===window.variables.ZERO?BASE_SYMBOL:e.symbol}function onConfirmSwap(){return _onConfirmSwap.apply(this,arguments)}function _onConfirmSwap(){return(_onConfirmSwap=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,o,a,i,s,c,u,p,d,l,m,f,b,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=TOKENS,n=t.from,r=t.to,$(".popup-overlay#confirm_swap").fadeOut(200),$(".popup-overlay#pending_transaction").fadeIn(200),$(".popup__pending-details-info").text("\n    Swapping ".concat(n.amount.dp(6,1).toString(10)," ").concat(getTokenSymbol(n.token)," for ").concat(r.amount.dp(6,1).toString(10)," ").concat(getTokenSymbol(r.token),"\n  ")),o=window.variables,a=o.ACCOUNT,i=o.ROUTER_CONTRACT,s=o.CONTRACT_ROUTER_ADDRESS,c=o.ZERO,u=o.WETH,e.next=7,getBlockInfo();case 7:if(p=e.sent,![n.token.address,r.token.address].includes(c)){e.next=37;break}if(n.token.address===c)return d=i.methods.swapExactETHForTokensSupportingFeeOnTransferTokens("0x".concat(toWei(r.amount,r.token.decimals).times(100-SETTINGS.slippage).div(100).dp(0,0).toString(16)),midToken?[u,midToken,r.token.address]:[u,r.token.address],a,p.timestamp+60*SETTINGS.deadline).encodeABI(),e.t0=a,e.t1=s,e.t2=window.web3.utils,e.next=16,window.web3.eth.getGasPrice();e.next=24;break;case 16:e.t3=e.sent,e.t4=e.t2.toHex.call(e.t2,e.t3),e.t5=d,e.t6="0x".concat(toWei(n.amount).toString(16)),l={from:e.t0,to:e.t1,gasPrice:e.t4,data:e.t5,value:e.t6},window.web3.eth.sendTransaction(l).on("transactionHash",function(e){handleTransactionSuccess(e),services.push({text:"Swap ".concat(n.amount.toFixed(4)," ").concat(BASE_SYMBOL," for ").concat(r.amount.toFixed(4)," ").concat(r.token.symbol),hash:e})}).on("receipt",function(e){console.log("transaction success"),services.update(e)}).on("error",function(e,t){console.log("err :>> ",e),handleTransactionError(),t&&services.update(t)}),e.next=35;break;case 24:return m=i.methods.swapExactTokensForETHSupportingFeeOnTransferTokens("0x".concat(toWei(n.amount,n.token.decimals).dp(0,0).toString(16)),"0x".concat(toWei(r.amount).times(100-SETTINGS.slippage).div(100).dp(0,0).toString(16)),midToken?[n.token.address,midToken,u]:[n.token.address,u],a,p.timestamp+60*SETTINGS.deadline).encodeABI(),e.t7=a,e.t8=s,e.t9=window.web3.utils,e.next=30,window.web3.eth.getGasPrice();case 30:e.t10=e.sent,e.t11=e.t9.toHex.call(e.t9,e.t10),e.t12=m,f={from:e.t7,to:e.t8,gasPrice:e.t11,data:e.t12,value:"0x0"},window.web3.eth.sendTransaction(f).on("transactionHash",function(e){handleTransactionSuccess(e),services.push({text:"Swap ".concat(n.amount.toFixed(4)," ").concat(n.token.symbol," for ").concat(r.amount.toFixed(4)," ").concat(BASE_SYMBOL),hash:e})}).on("receipt",function(e){services.update(e)}).on("error",function(e,t){console.log("err :>> ",e),handleTransactionError(),t&&services.update(t)});case 35:e.next=48;break;case 37:return b=i.methods.swapExactTokensForTokensSupportingFeeOnTransferTokens("0x".concat(toWei(n.amount,n.token.decimals).dp(0,0).toString(16)),"0x".concat(toWei(r.amount,r.token.decimals).times(100-SETTINGS.slippage).div(100).dp(0,0).toString(16)),midToken?[n.token.address,midToken,r.token.address]:[n.token.address,r.token.address],a,p.timestamp+60*SETTINGS.deadline).encodeABI(),e.t13=a,e.t14=s,e.t15=window.web3.utils,e.next=43,window.web3.eth.getGasPrice();case 43:e.t16=e.sent,e.t17=e.t15.toHex.call(e.t15,e.t16),e.t18=b,w={from:e.t13,to:e.t14,gasPrice:e.t17,data:e.t18,value:"0x0"},window.web3.eth.sendTransaction(w).on("transactionHash",function(e){handleTransactionSuccess(e),services.push({text:"Swap ".concat(n.amount.toFixed(4)," ").concat(n.token.symbol," for ").concat(r.amount.toFixed(4)," ").concat(r.token.symbol),hash:e})}).on("receipt",function(e){services.update(e)}).on("error",function(e,t){console.log("err :>> ",e),handleTransactionError(),t&&services.update(t)});case 48:case"end":return e.stop()}},e)}))).apply(this,arguments)}function onModalClose(){$(".popup-overlay").fadeOut(200)}function handleTransactionSuccess(e){$(".popup-overlay#pending_transaction").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup__transaction-img").attr("src","images/swap/submit.svg"),$(".popup-overlay .popup__transaction-title").text("Transaction Submitted"),$(".popup-overlay .popup__transaction-title").after('\n    <a\n      target="_blank"\n      rel="noopener noreferrer"\n      href="'.concat(netLink(e),'"\n      class="popup__transaction-link">\n      View on ').concat(netScan(),"\n    </a>\n  ")),$(".popup-overlay .popup__transaction-btn").text("Close"),clear()}function handleTransactionError(){$(".popup-overlay#pending_transaction").fadeOut(200),$(".popup-overlay#transaction_status").fadeIn(200),$(".popup-overlay .popup__transaction-title").text("Transaction Rejected."),$(".popup__transaction-img").attr("src","images/swap/error.svg"),$(".popup-overlay .popup__transaction-btn").text("Dismiss")}function onBalance(e,t){var n=$("#balance-".concat(t," span")).text();isNaN(n)||($(".swap-form").find('[data-input="'.concat(t,'"] input')).val(n),onInputAmount({target:{value:n}},t))}function onInputDeadline(e){SETTINGS.deadline=parseFloat(e.target.value||20)}